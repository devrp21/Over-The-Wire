# ðŸ”’ OverTheWire Krypton CTF â€“ Level 6

## ðŸŒ **Challenge Description**  
The password for the next level (Krypton 7) is stored in `/krypton/krypton6/krypton7` and is encrypted using a periodic cipher based on an 8-bit Linear Feedback Shift Register (**LFSR**).

---

## ðŸŽ¯ **Goal**  
- Analyze the encrypted file.  
- Use key analysis and periodic patterns to break the cipher.  
- Decrypt the ciphertext to retrieve the password.  

---

## ðŸš€ **Solution**  

### **Step 1: Connect to the Server**  
Use the following SSH command to connect to the server:

```bash
ssh krypton6@krypton.labs.overthewire.org -p 2231
```

- **Username:** `krypton6`  
- **Password:** `RANDOM`  

---

### **Step 2: Locate the Password File**  
Navigate to the `krypton6` folder:

```bash
cd /krypton/krypton6
ls -la
```

**Output:**  
```
total 56
drwxr-xr-x 3 root     root     4096 Sep 19 07:10 .
drwxr-xr-x 9 root     root     4096 Sep 19 07:10 ..
-rw-r--r-- 1 krypton6 krypton6  165 Sep 19 07:10 HINT1
-rw-r--r-- 1 krypton6 krypton6  164 Sep 19 07:10 HINT2
-rw-r----- 1 krypton6 krypton6   31 Sep 19 07:10 krypton7
-rw-r--r-- 1 krypton6 krypton6  521 Sep 19 07:10 keyfile.dat
-rwxr-xr-x 1 krypton6 krypton6 2320 Sep 19 07:10 encrypt6
-rw-r--r-- 1 krypton6 krypton6 4342 Sep 19 07:10 README
```

![ls-la](https://github.com/user-attachments/assets/2f07c3d5-5f37-4cf2-b79e-121a4664f132)

---

### **Step 3: Read the README File**  
The README file provides the following information:

```bash
cat README
```

![image](https://github.com/user-attachments/assets/7664986a-e0f8-439a-86a2-247b569d087b)

ðŸ“Œ **Key Insight:**  
- The encryption is periodic.  
- Frequency analysis will reveal the key pattern.  

Example from README:
```
Frequency analysis can break a known key length as well. Let's try one last polyalphabetic cipher, but this time the key length is unknown.
```

---

### **Step 4: Analyze the Hints**  
Check the contents of the hint files:

```bash
cat HINT1
```

**Output:**  
```
The 'random' generator has a limited number of bits and is periodic.
Entropy analysis and a good look at the bytes in a hex editor will help.
There is a pattern!
```

```bash
cat HINT2
```

**Output:**  
```bash
8 bit LFSR
```

![image](https://github.com/user-attachments/assets/5408b95f-f671-4fd5-9802-446ce9b411b9)

âœ… **Hint Summary:**  
- The cipher is based on a periodic key generated by an **8-bit Linear Feedback Shift Register (LFSR)**.  
- Entropy and pattern analysis can break it.  

---

### **Step 5: Generate the Key**  
Create a temporary directory to work in:

```bash
mkdir /tmp/useme/
cd /tmp/useme/
ln -s /krypton/krypton6/keyfile.dat
```

Generate test output to analyze the key:

```bash
python3 -c "print('A'*100)" > f1
/krypton/krypton6/encrypt6 f1 f2
cat f2; echo
```

**Output:**  
```
EICTDGYIYZKTHNSIRFXYCPFUEOCKRN
```

![image](https://github.com/user-attachments/assets/31c3f2e4-a8f5-4d1c-b27e-e2846cda9979)

âœ… **Generated Key:** `EICTDGYIYZKTHNSIRFXYCPFUEOCKRN`

---

### **Step 6: Analyze the Ciphertext**  
Check the contents of the `krypton7` file:

```bash
cat /krypton/krypton6/krypton7
```

**Output:**  
```bash
PNUKLYLWRQKGKBE
```

![image](https://github.com/user-attachments/assets/67f340f1-ada5-46a9-a253-deb126263369)

âœ… **Ciphertext:** `PNUKLYLWRQKGKBE`

---

### **Step 7: Create a Python Decryption Script**  
Create a `dec.py` file with the following content:

```python
key = 'EICTDGYIYZKTHNSIRFXYCPFUEOCKRN'
cipher = 'PNUKLYLWRQKGKBE'

pt = ''
for i in range(len(cipher)):
    tmp = ord(cipher[i]) - ord(key[i])
    if tmp < 0:
        tmp += 26
    tmp += ord('A')
    pt += chr(tmp)

print(pt)
```

---

### **Step 8: Run the Script**  
Execute the decryption script:

```bash
python3 dec.py
```

**Output:**  
```bash
LFSRISNOTRANDOM
```

![Password](https://github.com/user-attachments/assets/71fd79c5-2d25-49ba-b806-7d230a4a2438)

---

## âœ… **Password for Krypton Level 7**  
```bash
LFSRISNOTRANDOM
```

---

## ðŸŒŸ **Key Points**  
âœ”ï¸ Identified the periodic key generation using LFSR.  
âœ”ï¸ Extracted the key through frequency analysis.  
âœ”ï¸ Wrote a Python script to decode the ciphertext.  

---

## ðŸŽ¯ **Next Level**  
Use the password to access **Krypton Level 7**.  

---
